<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<title data-react-helmet="true">GAMA | Here We Build CityScope</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="GAMA | Here We Build CityScope"><meta data-react-helmet="true" name="description" content="Agent-Based Model developped in the CityScience group using Gama Platform and integrated in CityScope"><meta data-react-helmet="true" property="og:description" content="Agent-Based Model developped in the CityScience group using Gama Platform and integrated in CityScope"><meta data-react-helmet="true" property="og:url" content="https://cityscope.media.mit.edu/docs/modules/GAMA"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://cityscope.media.mit.edu/docs/modules/GAMA"><link rel="stylesheet" href="/styles.e06a12d2.css">
<link rel="preload" href="/styles.7ebf3a8b.js" as="script">
<link rel="preload" href="/runtime~main.6456e382.js" as="script">
<link rel="preload" href="/main.dbb211a4.js" as="script">
<link rel="preload" href="/1.01233fc6.js" as="script">
<link rel="preload" href="/2.be97788c.js" as="script">
<link rel="preload" href="/28.3f5d1eed.js" as="script">
<link rel="preload" href="/29.a30f9f3d.js" as="script">
<link rel="preload" href="/935f2afb.72482a92.js" as="script">
<link rel="preload" href="/17896441.b26342e0.js" as="script">
<link rel="preload" href="/675cb92d.0b255728.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/ML_logo.png" alt="Logo"><strong class="navbar__title">MIT CityScope</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/CityScope" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" src="img/">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/ML_logo.png" alt="Logo"><strong class="navbar__title">MIT CityScope</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/CityScope" target="_blank" rel="noopener noreferrer" class="menu__link" src="img/">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/CityScope Ecosystem">CityScope Ecosystem</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/Guideline">Guideline</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/Docs Development">Docs Development</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/Open Source">Open Source</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/License">License</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Frontend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/frontend/CityScopeJS">CityScopeJS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">User Interfaces</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/UI/UI Introduction">UI Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/UI/CityScoPy">CityScoPy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/UI/RoboScope">RoboScope</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Modules</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modules/Types System">Types System</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/modules/Brix">Brix</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/modules/GAMA">GAMA</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Backend</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/backend/CityIO/CityIO">CityIO</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Archive</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archive/Schema">Schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archive/Specs">Specs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/archive/Past CityScope Projects">Past CityScope Projects</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">GAMA</h1></header><div class="markdown"><p>Agent-Based Model developped in the <a href="https://www.media.mit.edu/groups/city-science/overview/" target="_blank" rel="noopener noreferrer">CityScience</a> group using <a href="https://gama-platform.github.io/" target="_blank" rel="noopener noreferrer">Gama Platform</a> and integrated in <a href="https://www.media.mit.edu/projects/cityscope/overview/" target="_blank" rel="noopener noreferrer">CityScope</a></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tutorial"></a>Tutorial<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tutorial" title="Direct link to heading">#</a></h1><p>If you donâ€™t have a specific table, you can create one <a href="https://cityscope.media.mit.edu/CS_cityscopeJS/" target="_blank" rel="noopener noreferrer">here</a>. For this tutorial, we crated one called <code>dungeonmaster</code>. In this tutorial we will see how to load a table in GAMA, instantiate a Grid, run an hello world simulation and send results back. </p><p>The first step is to add the import from the <code>GAMABrix.gaml</code> file. Right after declaring your model, import the necessary species and functions by running:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;GAMABrix.gaml&quot;</span></div></div></div></div></div><p>This will add to <code>global</code> the necessary functions to communicate with <code>CityIO</code> and three very important species that you will use to give your agents the properties they need to also live in CityIO: <code>cityio_numeric_indicator</code>, <code>cityio_heatmap_indicator</code>, and <code>cityio_agent</code>.</p><p>Think of <code>cityio_numeric_indicator</code> and <code>cityio_heatmap_indicator</code> as two observers in your model that will report information back to CityIO. Later, we&#x27;ll talk about how to create sub-species of these two species and how to create agents. <code>cityio_agent</code> is used as the parent class of any species that you want to visualize in CityIO. There are some specific parameters your sub-species needs to define, and we&#x27;ll talk about them later.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-cityio-global"></a>The CityIO global<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-cityio-global" title="Direct link to heading">#</a></h2><p>To connect your world to a table you need to declare the table name inside your <code>global</code>. For example, we named our table <code>dungeonmaster</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">string city_io_table&lt;-&quot;dungeonmaster&quot;;</span></div></div></div></div></div><p>While you are building your model, we recommend turning <code>GAMABrix</code> off speed up the process (the default). By setting <code>post_on&lt;-false</code>, the model will only update your local grid without posting any of the indicators to cityio. This will reduce your bandwidth usage and allow you to debug your model faster. </p><p>Once you are done and want to deploy, change:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">bool post_on&lt;-true;</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="input"></a>Input<a aria-hidden="true" tabindex="-1" class="hash-link" href="#input" title="Direct link to heading">#</a></h2><p>What is geogrid_data? Every time we create a CityScope table, we define a regularly spaced grid which is overlaid on the city district weâ€™re modelling. These grid cells are the basic unit of analysis for the CityScope modules. Every grid cell has properties such as the <code>Type</code> which represents the land use and <code>Height</code> which represents the number of floors. These data are dynamic and are updated each time a user interacts with the CityScope table, experimenting with the spatial organisation of land uses and infrastructure. These dynamic data are stored the variable <code>geogrid_data</code>. This is a list of ojects: one for each grid cell in the CityScope table. </p><p>In GAMA, the user does not need to be aware of <code>geogrid_data</code>. The <code>udpateGrid</code> action should make sure that the state of the simulated world matches the state of the table, and then the user just interacts with the simulated world. All the indicators are then a funcion of the local GAMA world, and not a direct function of <code>geogrid_data</code>. </p><p>The user will eventually interact with the <code>block</code> species. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="output"></a>Output<a aria-hidden="true" tabindex="-1" class="hash-link" href="#output" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="basic-numeric-indicator"></a>Basic numeric indicator<a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-numeric-indicator" title="Direct link to heading">#</a></h2><p>In GAMA, indicators are defined as agents from an indicator species. The species for numeric indicators is called <code>cityio_numeric_indicator</code>. There are two ways of creating a numeric indicator. </p><p>First, for simple calculations, you can create an agent of the <code>cityio_numeric_indicator</code> species and pass it the formula to be evaluated as:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">create cityio_numeric_indicator with: (viz_type:&quot;bar&quot;,indicator_name: &quot;Max Height&quot;, indicator_value: &quot;max(block collect each.height)&quot;);</span></div></div></div></div></div><p>This line of code creates a numeric indicator, called <code>Max height</code>, to be displayed as a <code>bar</code>, and that performs the calculation <code>max(block collect each.height)</code>, which gets the maximum height of all blocks. </p><p>Second, for more complex indicators it might make sense for the user to define its own species. This is done by creating a sub-species of the <code>cityio_numeric_indicator</code> species. The sub-species needs to define a <code>return_indicator</code> function that should return a <code>float</code>. The following example implements the same indicator as above:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">species my_cool_indicator parent: cityio_numeric_indicator {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    float return_indicator {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return max(block collect each.height);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>and in the <code>global init</code>  the useer creates:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">create my_cool_indicator with: (viz_type:&quot;bar&quot;,indicator_name: &quot;Number of blocks&quot;);</span></div></div></div></div></div><p>If the species is not created as a sub-species of <code>cityio_numeric_indicator</code>, the indicator will not update. </p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="running-gama-on-a-server-with-ssh-access"></a>Running GAMA on a server with ssh access<a aria-hidden="true" tabindex="-1" class="hash-link" href="#running-gama-on-a-server-with-ssh-access" title="Direct link to heading">#</a></h1><p>We highly recommend using a docker container to run GAMA on a headless server. This will take care of compatibility issues between platforms. </p><p>First, pull the image from dockerhub. This step only needs to be performed once per server. We will be using <a href="https://hub.docker.com/r/gamaplatform/gama" target="_blank" rel="noopener noreferrer">this image</a>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; docker pull gamaplatform/gama</span></div></div></div></div></div><p>Second, we will build the <code>xml</code> file with the model meta parameters. You will only need to do this once for each model. From your repo (the folder that contains models, results, etc), run:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; docker run --rm -v &quot;$(pwd)&quot;:/usr/lib/gama/headless/my_model gamaplatform/gama -xml CityScopeHeadless my_model/models/cityIO.gaml my_model/headless/myHeadlessModel.xml</span></div></div></div></div></div><p>This creates a file called <code>myHeadlessModel.xml</code> in your <code>headless</code> folder. If you know how to edit this file, feel free to modify it now. For more information about this file, check the <a href="https://gama-platform.github.io/wiki/Headless" target="_blank" rel="noopener noreferrer">documentation</a>.</p><p>Finally, we will run this model inside a container. This final step is what you will repeat everytime you modify your model. Run the following command, again from your model director:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; docker run --rm -v &quot;$(pwd)&quot;:/usr/lib/gama/headless/my_model gamaplatform/gama my_model/headless/myHeadlessModel.xml my_model/results/</span></div></div></div></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="examples"></a>Examples<a aria-hidden="true" tabindex="-1" class="hash-link" href="#examples" title="Direct link to heading">#</a></h1><p>Agents that randomly move on road network.
1) Pull road network from OSM
2) Place agents in network and make them move randomly.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/CityScope/cityscope.github.io/blob/new_docsite/docsite/docs/modules/GAMA.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/modules/Brix"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Brix</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/backend/CityIO/CityIO"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CityIO Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-cityio-global" class="table-of-contents__link">The CityIO global</a></li><li><a href="#input" class="table-of-contents__link">Input</a></li><li><a href="#output" class="table-of-contents__link">Output</a></li><li><a href="#basic-numeric-indicator" class="table-of-contents__link">Basic numeric indicator</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div class="margin-bottom--sm"><a href="https://github.com/CityScope" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1zJy"><img class="footer__logo" alt="Logo" src="/img/ML_logo_sml.png"></a></div><div>Copyright Â© 2020 CityScope, MIT City Science</div></div></div></footer></div>
<script src="/styles.7ebf3a8b.js"></script>
<script src="/runtime~main.6456e382.js"></script>
<script src="/main.dbb211a4.js"></script>
<script src="/1.01233fc6.js"></script>
<script src="/2.be97788c.js"></script>
<script src="/28.3f5d1eed.js"></script>
<script src="/29.a30f9f3d.js"></script>
<script src="/935f2afb.72482a92.js"></script>
<script src="/17896441.b26342e0.js"></script>
<script src="/675cb92d.0b255728.js"></script>
</body>
</html>