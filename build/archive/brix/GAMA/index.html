<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-archive/brix/GAMA" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">GAMA | Here We Build CityScope</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cityscope.media.mit.edu/archive/brix/GAMA"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="GAMA | Here We Build CityScope"><meta data-rh="true" name="description" content="Agent-Based Model developped in the CityScience group using Gama Platform and integrated in CityScope"><meta data-rh="true" property="og:description" content="Agent-Based Model developped in the CityScience group using Gama Platform and integrated in CityScope"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cityscope.media.mit.edu/archive/brix/GAMA"><link data-rh="true" rel="alternate" href="https://cityscope.media.mit.edu/archive/brix/GAMA" hreflang="en"><link data-rh="true" rel="alternate" href="https://cityscope.media.mit.edu/archive/brix/GAMA" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a961cfe0.css">
<script src="/assets/js/runtime~main.3bfd9d4e.js" defer="defer"></script>
<script src="/assets/js/main.1f802b69.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ML_logo.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/ML_logo.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MIT CityScope</b></a></div><div class="navbar__items navbar__items--right"><a href="https://cityscope.media.mit.edu/CS_cityscopeJS" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" src="img/">CityScopeJS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/CityScope" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" src="img/">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/">CityScope</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/">Introduction</a><button aria-label="Expand sidebar category &#x27;Introduction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/category/cityscopejs">CityScopeJS</a><button aria-label="Expand sidebar category &#x27;CityScopeJS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/category/modules">Modules</a><button aria-label="Expand sidebar category &#x27;Modules&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/category/cityio">CityIO</a><button aria-label="Expand sidebar category &#x27;CityIO&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/category/tangible-user-interfaces">Tangible User Interfaces</a><button aria-label="Expand sidebar category &#x27;Tangible User Interfaces&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/category/archive">Archive</a><button aria-label="Collapse sidebar category &#x27;Archive&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/archive/h3/">[Archive] H3 Grid</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/archive/brix/">[Archive] The brix library</a><button aria-label="Collapse sidebar category &#x27;[Archive] The brix library&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/archive/brix/Examples/">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/archive/brix/GAMA">GAMA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/archive/brix/Tutorial/">Tutorials</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/archive/cityio/">[Archive] CityIO</a><button aria-label="Expand sidebar category &#x27;[Archive] CityIO&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">CityScope</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/archive"><span itemprop="name">Archive</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/archive/brix/"><span itemprop="name">[Archive] The brix library</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">GAMA</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p>Agent-Based Model developped in the <a href="https://www.media.mit.edu/groups/city-science/overview/" target="_blank" rel="noopener noreferrer">CityScience</a> group using <a href="https://gama-platform.github.io/" target="_blank" rel="noopener noreferrer">Gama Platform</a> and integrated in <a href="https://www.media.mit.edu/projects/cityscope/overview/" target="_blank" rel="noopener noreferrer">CityScope</a></p>
<h1>Introduction</h1>
<p>What is this library for? If you have never heard of a CityScope before, you might want to stop reading and learn about them <a href="https://cityscope.media.mit.edu/" target="_blank" rel="noopener noreferrer">here</a>. CityScope is an awesome way to interact, explore, and co-create urban interventions in a way that can be accessed by multiple people with different background. If you know what they are, please keep reading.</p>
<p>What is a CityScope table? a ‘table’ is our way of describing a CityScope project. Why table then? Since historically, most CityScope instances were composed of a mesh between a physical table-top 3D model of a city, augmented with projections, software, and other interface hardware. So a table =&gt; project.</p>
<p>What is an indicator? An indicator is the result of running a module for CityScope. Indicators work by listening for updated from the CityScope table they are linked to, calculating some values by using a model, some function of the data, or a simulation, and then post the result of the calculations to CityIO to be displayed in the table.</p>
<p>What are the types of indicators you can build? Indicators can be anything that could be displayed on a CityScope table, including the supporting screens associated to it. For the purpose of this library, we distinguish three types of indicator: numeric, heatmap, simulation.</p>
<ul>
<li>
<p>Numeric: Numeric indicators are just a number or set of numbers. They are usually displayed in a chart (bar chart, radar chart, etc) next to the table. The most common numeric indicator are the numbers that go in the radar plot, which display information about density, diversity, and proximity.</p>
</li>
<li>
<p>Heatmap: These indicators are geodata. They are made up of geometries (points, lines, or polygons) and properties associated to them. These indicators are displayed as layers directly on the CityScope table.</p>
</li>
<li>
<p>Agent: These type of indicators are also displayed on the table but they are the result of an agent based simulation and are therefore displayed as a dynamic layer. They change over time like a short movie.</p>
</li>
</ul>
<h1>Setup</h1>
<p>To setup GAMABrix copy the file <code>GAMABrix.gaml</code> into your model directory and import it into your model. You can download <code>GAMABrix.gaml</code> from <a href="https://github.com/CityScope/CS_Simulation_GAMA/blob/master/CS_CityScope_GAMA/models/cityIO/models/GAMABrix.gaml" target="_blank" rel="noopener noreferrer">here</a> Right after declaring your model, import the necessary species and functions by running:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;GAMABrix.gaml&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will add to <code>global</code> the necessary functions to communicate with <code>CityIO</code> and two very important species that you will use to give your agents the properties they need to also live in CityIO: <code>cityio_numeric_indicator</code> and <code>cityio_agent</code>. Additionally, it sets up a series of <code>brix</code> agents that will ensure your world is a copy of the world in the table you have selected.</p>
<h1>Tutorial</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basics-of-building-a-cityscope-indicator-in-gama">Basics of building a CityScope indicator in GAMA<a href="#basics-of-building-a-cityscope-indicator-in-gama" class="hash-link" aria-label="Direct link to Basics of building a CityScope indicator in GAMA" title="Direct link to Basics of building a CityScope indicator in GAMA">​</a></h2>
<p>Let’s get to it. First, what table are you building for? If you don’t have a specific table, that is totally okay and you can create one <a href="https://cityscope.media.mit.edu/CS_cityscopeJS/" target="_blank" rel="noopener noreferrer">here</a>. Note: by the time you read this, CityScope might pose some limitations on new projects (<code>tables</code>). Please follow instructions in the link above.</p>
<p>For this tutorial, we crated one called <code>dungeonmaster</code>.</p>
<p>An indicator will basically take in the properties of the <code>brix</code> agents in the world or the properties of any other simulated agent and produce a result. Each new indicator is built as an subclass of the <code>cityio_agent</code> class. <code>cityio_agent</code> is your friend, so we&#x27;ll spend some time discussing it here.</p>
<p>When you setup a model by importing <code>GAMABrix</code>, the model will run for one whole day of simulation, then posts the results of this simulation to cityio, and then stay idle waiting for an update from the table. This can be a bit annoying when you are only starting to build your model, so you can turn off this behavior and just keep the local grid update.</p>
<p>Think of each indicator as an observer in your model that will report information back to CityIO. When it&#x27;s a numeric indicator, the agent will just report a number that it calculates based on the <code>brix</code>s, when it&#x27;s a heatmap indicator, the agent will report some numbers along with its location, and when it&#x27;s an agent, the agent will report it&#x27;s location over time. <code>cityio_agent</code> is used as the parent class of any species that you want to visualize in CityIO. There are some specific parameters your sub-species needs to define to set the agent as a numeric, heatmap, or agent indicator.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gamabrix-for-cs-brix-users">GAMABrix for <code>cs-brix</code> users<a href="#gamabrix-for-cs-brix-users" class="hash-link" aria-label="Direct link to gamabrix-for-cs-brix-users" title="Direct link to gamabrix-for-cs-brix-users">​</a></h2>
<p>If you are familiar with the python library <a href="https://cityscope.media.mit.edu/CS_Brix/" target="_blank" rel="noopener noreferrer">cs-brix</a>, keep reading. Otherwise, skip to the next section of the tutorial. <code>brix</code> is relies on defining classes that contain functions that take <code>geogrid_data</code> as an input. For <code>GAMABrix</code> this is not necessary. Since <code>GAMA</code> relies on setting up a world with agents, the input data is already in the world in the form of <code>brix</code>. Therefore, when building urban indicators in <code>GAMA</code> you do not need to worry about input, and you can just get the necessary information from the <code>brix</code> agents that will be automatically created in your world.</p>
<p>In terms of output, <code>brix</code> relies on a series of return functions passed to a <code>Handler</code> class. In <code>GAMA</code>, the world itself acts as the <code>Handler</code> class, so there is no need to explicitly add your indicators to the <code>Handler</code> as they are already contained in the <code>global</code> species. The way to flag your indicators to be sent to <code>cityIO</code> is to define them as a subclass of <code>cityio_agent</code>.</p>
<p>While <code>brix</code> can handle multiple tables at the same time by creating multiple threads for each <code>Handler</code>, <code>GAMA</code> is constrained to one table per model.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-cityio-global">The CityIO global<a href="#the-cityio-global" class="hash-link" aria-label="Direct link to The CityIO global" title="Direct link to The CityIO global">​</a></h2>
<p>To connect your world to a table you need to declare the table name inside your <code>global</code> and set the geometry of your world based on this table. For example, we named our table <code>dungeonmaster</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">string city_io_table&lt;-&quot;dungeonmaster&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">geometry shape &lt;- envelope(setup_cityio_world());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>While you are building your model, we recommend turning off <code>GAMABrix</code> to speed up the process (the default). By setting <code>post_on&lt;-false</code>, the model will only update your local grid without posting any of the indicators to cityio. In other words, you will only be <em>getting</em> from <code>cityIO</code> not <em>posting</em>. This will reduce your bandwidth usage and allow you to debug your model faster. By doing this, the model will still keep track of the day and enter idle mode once the day is over.</p>
<p>For early stages of model building, you might also want to set <code>pull_only&lt;-true</code>. This will tell turn off most of the functionality of the module and just make sure you are updating the local grid by pulling from your table. The simulation will not enter idle mode and the day will never reset.</p>
<p>Once you are done and want to deploy, change:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">bool post_on&lt;-true;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Additionally, the following variables can be defined in the <code>global</code> and allow for a finer control of how the <code>global</code> communicates with <code>cityIO</code>. You do not need to set them up now, as the default should work fine.</p>
<ul>
<li><code>city_io_table</code>: String, name of the table to connect to.</li>
<li><code>post_on</code>: Boolean, used to turn the posting feature on or off. Keep it off while building the model and turn it on to post to the table.</li>
<li><code>update_frequency</code>: Intenger, frequency, in number of simulation ticks, by which to update local grid by checking for changes in gridhash. This is not the posting frequency. Optional, and defaults to <code>10</code>.</li>
<li><code>send_first_batch</code>: Boolean, if <code>false</code> it will only send the results of the simulation once the full day has run. Optional and defaults to <code>true</code>.</li>
<li><code>cycle_first_batch</code>: Integer, simulation tick in which to send the first batch of data to the server. Optional and defaults to <code>100</code>.</li>
<li><code>step</code>: Float, time between two simulation ticks. Defaults to <code>60 #sec</code>.</li>
<li><code>saveLocationInterval</code>: Float, frequency in second by which to save locally the location of agents. This is not the post frequency. Optional and defaults to <code>10</code> steps.</li>
<li><code>totalTimeInSec</code>: Integer, total time in seconds that the simulation will run for. Defaults to a whole day. Please note that <code>CityIO</code> will not render more than 1 day of simulation.</li>
<li><code>idle_update_frequency</code>: Float, time in real world seconds (not simulation seconds) between two get requests to check hash when in idle mode.</li>
<li><code>pull_only</code>: Boolean, used to use GAMABrix only to update the local grid. This is very useful for the early stages of model building.</li>
</ul>
<p>When you import <code>GAMABrix</code> you will also see an additional experiment called <code>CityScopeHeadless</code>. This experiment is used to run your model as a headless process in a server.</p>
<p>By default, <code>GAMABrix</code> will run its init (which creates the grid) right after your model&#x27;s init. This means that you will not have access to any <code>brix</code> object inside your init. You can always change this behavior by forcing <code>GAMABrix</code> to run its init earlyer by adding <code>do brix_init</code> where needed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-talk-input">Let&#x27;s talk input<a href="#lets-talk-input" class="hash-link" aria-label="Direct link to Let&#x27;s talk input" title="Direct link to Let&#x27;s talk input">​</a></h2>
<p><code>GAMA</code> will keep a copy of the <code>cityIO</code> grid locally by creating the necessary <code>brix</code> agents. This makes all the grid information accessible to all the agents by interacting with the <code>brix</code> agents.</p>
<p>The main properties that <code>brix</code> agents have are:</p>
<ul>
<li>type: String that identifies the type of the block. This is editable (e.g. <code>Residential</code>).</li>
<li>height: Float, height of the block.</li>
<li>color: RGB object.</li>
<li>block_lbcs: <code>map&lt;string, float&gt;</code> Map that connects strings (LBCS codes) and float (proportion of the block in each code).</li>
<li>block_naics: <code>map&lt;string, float&gt;</code> Map that connects strings (NAICS codes) and float (proportion of the block in each code).</li>
</ul>
<p>Note that <code>block_lbcs</code> and <code>block_naics</code> are the same for each <code>type</code> and are defined when you create the table.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-an-indicator-output">Building an indicator (output)<a href="#building-an-indicator-output" class="hash-link" aria-label="Direct link to Building an indicator (output)" title="Direct link to Building an indicator (output)">​</a></h2>
<p>Now, we&#x27;ll turn some agents into observers that will report information to <code>cityIO</code>. All three different types of indicators report different types of information, and an agent can be reporting any type of information to <code>cityIO</code>.</p>
<ul>
<li>Numeric: Reports numbers (e.g. average commuting time, total energy consumption, etc.). Turn this on by setting <code>is_numeric&lt;-true</code>.</li>
<li>Heatmap: Reports numbers with location (e.g. traffic in a particular intersection, total sunlight in a specific location). Turn this on by setting <code>is_heatmap&lt;-true</code>.</li>
<li>Agent: Report all their locations during one whole day of simulation. Turn this on by setting <code>is_visible&lt;-true</code>. Note that the variable <code>is_visible</code> refers only to wether you&#x27;ll see the agent in your CityScope table. You still need to <code>display</code> them in your local GAMA interfase if you want to see them.</li>
</ul>
<p>When creating a numeric indicator you need to write a <code>reflex</code> for your agent that updates either <code>numeric_values</code> or <code>heatmap_values</code>. These two variables should be <code>map&lt;string,float&gt;</code>. Here is a simple example that <code>numeric_values</code> with the number of blocks.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">reflex update_numeric {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	numeric_values&lt;-[];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	numeric_values&lt;+&quot;Number of blocks&quot;::length(brix);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Similarly, here is another example that updates <code>heatmap_values</code> with two layers, <code>heat</code> and <code>map</code> defined as random numbers:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">reflex update_heatmap {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	heatmap_values&lt;-[];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	heatmap_values&lt;+ &quot;heat&quot;::rnd(10);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	heatmap_values&lt;+ &quot;map&quot;::rnd(10);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For an agent indicator there is no value to be updated, as the indicator just reports its location. However, if your agent does not move, you will get a very boring dot so you might want to update the location. Here is a simple <code>reflex</code> that updates the location:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">reflex move{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	do wander;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Additionally, <code>GAMABrix</code> provides a shortcut to create numeric indicators that do not require you to define a subspecies. This is meant for straightforward indicators that can be calculated in one line of code. To create a simple numeric indicator, just create and agent of the <code>cityio_numeric_indicator</code> species and pass your function as a string to <code>indicator_value</code>. For example, a numeric indicator that returns the average height of blocks:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">create cityio_numeric_indicator with: (viz_type:&quot;bar&quot;,indicator_name: &quot;Mean Height&quot;, indicator_value: &quot;mean(brix collect each.height)&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-your-indicator">Deploy your indicator<a href="#deploy-your-indicator" class="hash-link" aria-label="Direct link to Deploy your indicator" title="Direct link to Deploy your indicator">​</a></h2>
<p>Let&#x27;s say you finished writing your model and are ready to leave it running forever (in a server with ssh access, for example).</p>
<p>We highly recommend using a docker container to run headless GAMA on a server. This will take care of compatibility issues between platforms.</p>
<p>First, pull the image from dockerhub. This step only needs to be performed once per server. We will be using <a href="https://hub.docker.com/r/gamaplatform/gama" target="_blank" rel="noopener noreferrer">this image</a>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; docker pull gamaplatform/gama</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Second, we will build the <code>xml</code> file with the model meta parameters. You will only need to do this once for each model. Ensure you model directory (the folder that contains models, results, etc) contains a <code>headless</code> folder, and then run the following command adding the name of your gama file (<code>model_file.gaml</code>) where needed:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; docker run --rm -v &quot;$(pwd)&quot;:/usr/lib/gama/headless/my_model gamaplatform/gama -xml CityScopeHeadless my_model/models/[model_file.gaml] my_model/headless/myHeadlessModel.xml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This creates a file called <code>myHeadlessModel.xml</code> in your <code>headless</code> folder. If you know how to edit this file, feel free to modify it now. For more information about this file, check the <a href="https://gama-platform.github.io/wiki/Headless" target="_blank" rel="noopener noreferrer">documentation</a>. Please note that by default the simulation will only run 1000 steps. If you wish to change this, edit the <code>xml</code> and change the <code>finalStep</code> property to a higher number or just delete if you wish the model to run continuosly.</p>
<p>Finally, we will run this model inside a container. This final step is what you will repeat everytime you modify your model. Run the following command, again from your model director:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; docker run --rm -v &quot;$(pwd)&quot;:/usr/lib/gama/headless/my_model gamaplatform/gama my_model/headless/myHeadlessModel.xml my_model/results/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Examples</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-numeric-indicator">Basic numeric indicator<a href="#basic-numeric-indicator" class="hash-link" aria-label="Direct link to Basic numeric indicator" title="Direct link to Basic numeric indicator">​</a></h2>
<p>To create a numeric indicator, the recommended way is to define a species of agents that will act as <em>observers</em> that will report the information to <code>cityIO</code>. This species needs to have <code>cityio_agent</code> as parent species.</p>
<p>You need to define four things:</p>
<ul>
<li>Set <code>is_numeric</code> to <code>true</code>.</li>
<li>Define a reflex that updates the <code>numeric_values</code> map (<code>map&lt;string,float&gt;</code>).</li>
<li>Define an <code>indicator_name</code> either in the species definition or in the create statement.</li>
<li>Set the <code>viz_type</code> to either <code>bar</code> or <code>radar</code> (defaults to <code>bar</code> if you don&#x27;t change it).</li>
</ul>
<p>Here&#x27;s a simple example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">species my_numeric_indicator parent: cityio_agent {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	bool is_numeric&lt;-true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	string viz_type &lt;- &quot;bar&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	string indicator_name&lt;-&quot;Table Size&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	reflex update_numeric {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		numeric_values&lt;-[];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		numeric_values&lt;+indicator_name::length(brix);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Don&#x27;t forget to create an agent of this species in the <code>global</code> <code>init</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">create my_numeric_indicator;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For simple indicators, you can rely on creating an agent of the <code>cityio_numeric_indicator</code> species in your <code>global</code> <code>init</code>. Here&#x27;s an example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">create cityio_numeric_indicator with: (viz_type:&quot;bar&quot;, indicator_name: &quot;Max Height&quot;,  indicator_value: &quot;max(brix collect each.height)&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-heatmap-indicator">Basic heatmap indicator<a href="#basic-heatmap-indicator" class="hash-link" aria-label="Direct link to Basic heatmap indicator" title="Direct link to Basic heatmap indicator">​</a></h2>
<p>To create a heatmap indicator, define a species of agents that will act as <em>observers</em> that will report the information to <code>cityIO</code>. These agents need to have a location assigned to them. This species needs to have <code>cityio_agent</code> as parent species.</p>
<p>You need to define three things:</p>
<ul>
<li>Set <code>is_heatmap</code> to <code>true</code>.</li>
<li>Define a reflex that updates the <code>heatmap_values</code> map (<code>map&lt;string,float&gt;</code>).</li>
<li>Define an <code>indicator_name</code> either in the species definition or in the create statement.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">species thermometer parent: cityio_agent {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	bool is_heatmap&lt;-true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	string indicator_name&lt;-&quot;thermometer&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	reflex update_heatmap {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		heatmap_values&lt;-[];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		heatmap_values&lt;+ &quot;heat&quot;::rnd(10);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		heatmap_values&lt;+ &quot;map&quot;::rnd(10);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-agent-indicator">Basic agent indicator<a href="#basic-agent-indicator" class="hash-link" aria-label="Direct link to Basic agent indicator" title="Direct link to Basic agent indicator">​</a></h2>
<p>Finally, you can easily add agents to be displayed in <code>cityIO</code>. Interestingly, these are the easiest indicators to define. In fact, you can turn any species into a <code>cityio_agent</code> by defining their parent class.</p>
<p>You need to is_visible two things:</p>
<ul>
<li>Set <code>is_heatmap</code> to <code>true</code>.</li>
<li>Define a reflex that updates the agent&#x27;s location.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">species people parent: cityio_agent skills:[moving]{ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	bool is_visible&lt;-true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	reflex move{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		do wander;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Additionally, you can define the integers <code>profile</code> and <code>mode</code> that will control the way they are displayed in the front end. You can also define reflexes that update these two properties. For example, you can differentiate between drivers and walkers, or between day workers and night workers, etc.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="full-module-example-with-comments">Full module example (with comments)<a href="#full-module-example-with-comments" class="hash-link" aria-label="Direct link to Full module example (with comments)" title="Direct link to Full module example (with comments)">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">model citIOGAMA</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Import GAMABrix (this needs to be in the same directory as your model)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import &quot;GAMABrix.gaml&quot; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">global {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Define the table you&#x27;ll be working with</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	string city_io_table&lt;-&quot;dungeonmaster&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    geometry shape &lt;- envelope(setup_cityio_world());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // Set post to true so that GAMABrix can post to cityIO</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	bool post_on&lt;-true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	init {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		// Create people based on species defined below</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		create people number:10; </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		// Create 100 points of a heatmap indicator (species defined below)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		create thermometer number:100;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		// Use cityio_numeric_indicator to define a mean block height numeric indicator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		create cityio_numeric_indicator with: (viz_type:&quot;bar&quot;,indicator_name: &quot;Mean Height&quot;, indicator_value: &quot;mean(brix collect each.height)&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		// Create a numeric indicator based on the species defined below</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		create my_numeric_indicator     with: (viz_type:&quot;bar&quot;,indicator_name: &quot;Number of blocks&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Define a custom numeric indicator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">species my_numeric_indicator parent: cityio_agent {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Set the indicator as numeric</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	bool is_numeric&lt;-true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Visualize it as a bar chart</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	string viz_type &lt;- &quot;bar&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Define reflex that updates numeric_values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	reflex update_numeric {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		numeric_values&lt;-[];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		numeric_values&lt;+indicator_name::length(brix);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Define custom heatmap indicator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">species thermometer parent: cityio_agent {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Set the indicator as heatmap</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	bool is_heatmap&lt;-true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Define reflex that updates heatmap_values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	reflex update_heatmap {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		heatmap_values&lt;-[];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		heatmap_values&lt;+ &quot;heat&quot;::rnd(10);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		heatmap_values&lt;+ &quot;map&quot;::rnd(10);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Define people, to be used as agent indicators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">species people parent: cityio_agent skills:[moving]{ </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Set agents as visible in cityIO</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	bool is_visible&lt;-true;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Update the agents location at every step</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	reflex move{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		do wander;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	// Set base aspect to visualize in GAMA GUI</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	aspect base{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		draw circle(10) color:#blue;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Define a experiment to visualize in GUI</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">experiment CityScope type: gui autorun:false{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	output {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		display map_mode type:opengl background:#black{	</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">			species brix aspect:base;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">			species people aspect:base position:{0,0,0.1};</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/CityScope/cityscope.github.io/docs/archive/brix/GAMA.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/archive/brix/Examples/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Examples</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/archive/brix/Tutorial/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorials</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basics-of-building-a-cityscope-indicator-in-gama" class="table-of-contents__link toc-highlight">Basics of building a CityScope indicator in GAMA</a></li><li><a href="#gamabrix-for-cs-brix-users" class="table-of-contents__link toc-highlight">GAMABrix for <code>cs-brix</code> users</a></li><li><a href="#the-cityio-global" class="table-of-contents__link toc-highlight">The CityIO global</a></li><li><a href="#lets-talk-input" class="table-of-contents__link toc-highlight">Let&#39;s talk input</a></li><li><a href="#building-an-indicator-output" class="table-of-contents__link toc-highlight">Building an indicator (output)</a></li><li><a href="#deploy-your-indicator" class="table-of-contents__link toc-highlight">Deploy your indicator</a></li><li><a href="#basic-numeric-indicator" class="table-of-contents__link toc-highlight">Basic numeric indicator</a></li><li><a href="#basic-heatmap-indicator" class="table-of-contents__link toc-highlight">Basic heatmap indicator</a></li><li><a href="#basic-agent-indicator" class="table-of-contents__link toc-highlight">Basic agent indicator</a></li><li><a href="#full-module-example-with-comments" class="table-of-contents__link toc-highlight">Full module example (with comments)</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://github.com/CityScope" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/ML_logo_sml.png" alt="Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/ML_logo_sml.png" alt="Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">CityScope, MIT City Science 2024</div></div></div></footer></div>
</body>
</html>