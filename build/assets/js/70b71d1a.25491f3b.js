"use strict";(self.webpackChunkcityscope_docs=self.webpackChunkcityscope_docs||[]).push([[730],{977:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var s=n(4848),i=n(8453);const o={sidebar_position:2},r=void 0,c={id:"cityio/Architecture",title:"Architecture",description:"WebSockets: definition and use",source:"@site/docs/cityio/Architecture.md",sourceDirName:"cityio",slug:"/cityio/Architecture",permalink:"/cityio/Architecture",draft:!1,unlisted:!1,editUrl:"https://github.com/CityScope/cityscope.github.io/docs/cityio/Architecture.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"sidebar",previous:{title:"Introduction",permalink:"/cityio/Introduction"},next:{title:"CityIO - UI",permalink:"/cityio/CityIO - UI"}},a={},d=[{value:"WebSockets: definition and use",id:"websockets-definition-and-use",level:2},{value:"WebSockets Messages",id:"websockets-messages",level:2},{value:"HTTP API",id:"http-api",level:2},{value:"Interfaces",id:"interfaces",level:2}];function l(e){const t={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"websockets-definition-and-use",children:"WebSockets: definition and use"}),"\n",(0,s.jsx)(t.p,{children:"WebSockets provide a way for two-way communication between a client and a server over a single, long-lived connection. This is different from the traditional HTTP request-response model, where each request opens a new connection (or reuses an existing connection in a limited way), and the server cannot send messages to the client unless explicitly requested. WebSockets allow the server to send messages to the client at any time, facilitating real-time data transfer and interactive applications."}),"\n",(0,s.jsx)(t.p,{children:"In our scenario, CityIO is a message broker that collects, processes, and distributes urban data, and CityScopeJS is a web-based user interface that visualizes this data for analysis and decision-making."}),"\n",(0,s.jsx)(t.p,{children:"Using WebSockets CityScopeJS establishes a WebSocket connection to CityIO when a user opens a project. This single connection stays open for the duration of the user's session. Whenever CityIO has new data or updates, it can immediately push this data to CityScopeJS over the WebSocket connection. CityScopeJS receives the data in real-time and updates the visualizations accordingly. This setup minimizes network overhead, reduces server load, and provides a seamless, real-time user experience."}),"\n",(0,s.jsx)(t.h2,{id:"websockets-messages",children:"WebSockets Messages"}),"\n",(0,s.jsx)(t.p,{children:"The WebSocket messages exchanged between CityIO, the user interfaces (UIs), and the modules will adhere to the following structure, which is represented as a JSON schema:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n    "title": "websocket-message",\n    "description": "Structure of the websocket messages",\n    "type": "object",\n    "properties": {\n        "type":{\n            "type": "string"\n        },\n        "content":{\n            "type": "object"\n        }\n     }\n}\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The property ",(0,s.jsx)(t.strong,{children:"type"})," will indicate what type of message is sending the entity."]}),"\n",(0,s.jsxs)(t.li,{children:["the property ",(0,s.jsx)(t.strong,{children:"content"})," will differ depending on the type of the message; should contain the information needed for the destination entity to process the message."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Upon reception of a message, the CityScope entity (CityIO, User Interfaces, or Modules) will follow the next steps:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Parses the message as a JSON, using the previous schema."}),"\n",(0,s.jsxs)(t.li,{children:["Reads the type property:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"If the type is recognized, reads the content property and executes the proper action."}),"\n",(0,s.jsx)(t.li,{children:"Otherwise, the message is discarted."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"http-api",children:"HTTP API"}),"\n",(0,s.jsx)(t.p,{children:"CityIO features an HTTP API that enables users to access a wide range of information about various projects. The REST API is designed to maintain compatibility with the previous version of CityIO, ensuring that older modules can seamlessly communicate with this new component."}),"\n",(0,s.jsx)(t.h2,{id:"interfaces",children:"Interfaces"}),"\n",(0,s.jsx)(t.p,{children:"The available interfaces, as previously mentioned, include the following:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Websocket channel ",(0,s.jsx)(t.strong,{children:"/interface"}),": interface to exchange messages with interfaces."]}),"\n",(0,s.jsxs)(t.li,{children:["Websocket channel ",(0,s.jsx)(t.strong,{children:"/module"}),": interface to exchange messages with modules."]}),"\n",(0,s.jsxs)(t.li,{children:["Websocket channel ",(0,s.jsx)(t.strong,{children:"/module/core"}),": interface to exchange messages with core modules."]}),"\n",(0,s.jsxs)(t.li,{children:["API REST ",(0,s.jsx)(t.strong,{children:"/api"}),": HTTP interface to obtain information from CityIO."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var s=n(6540);const i={},o=s.createContext(i);function r(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);