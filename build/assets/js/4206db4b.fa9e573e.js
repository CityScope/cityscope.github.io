"use strict";(self.webpackChunkcityscope_docs=self.webpackChunkcityscope_docs||[]).push([[887],{2635:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>d,toc:()=>l});var i=t(4848),s=t(8453);const a={id:"API"},c="list tables",d={id:"archive/cityio/API",title:"API",description:"Here is a list of APIs exposed for cityio.",source:"@site/docs/archive/cityio/api.md",sourceDirName:"archive/cityio",slug:"/archive/cityio/API",permalink:"/archive/cityio/API",draft:!1,unlisted:!1,editUrl:"https://github.com/CityScope/cityscope.github.io/docs/archive/cityio/api.md",tags:[],version:"current",frontMatter:{id:"API"},sidebar:"sidebar",previous:{title:"[Archive] CityIO",permalink:"/archive/cityio/"},next:{title:"Build",permalink:"/archive/cityio/Build"}},r={},l=[];function o(e){const n={code:"code",h1:"h1",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Here is a list of APIs exposed for cityio."}),"\n",(0,i.jsx)(n.h1,{id:"list-tables",children:"list tables"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/tables/list/\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'["test"]\n'})}),"\n",(0,i.jsx)(n.h1,{id:"get-a-table",children:"get a table"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/table/test/ | jq .\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"| jq ."})," is just to pretty format the result."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "data": 42,\n  "grid": [\n    0,\n    1,\n    0\n  ],\n  "meta": {\n    "hash": "BGuzwcPaxADXvLkR2uciX1pkRumFGJV25UENUur4mUfa",\n    "hashes": {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "D9VCvyZn98K9BfSAX26Nm22DTsCfbULokywhdTFKs9Ca"\n    },\n    "id": "F4tCJsaHmvqu2VRGht4Z4GdMttEArHewfUKiFFVz1w78",\n    "timestamp": "2021-03-27T15:41:45.457952355+00:00"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h1,{id:"post-a-table",children:"post a table"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST -d \'{"grid":[0,1,1]}\' \\\n-H "Content-Type:application/json" \\\nhttps://cityio.media.mit.edu/api/table/test/ | jq .\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "id": "6xU8W2WTzwMpyX3vQyRxkbKFxVLfpeV6dERkK9ATukBT",\n  "name": "test",\n  "status": "ok"\n}\n'})}),"\n",(0,i.jsx)(n.h1,{id:"get-deeper-data",children:"get deeper data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/table/test/grid | jq .\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"[\n  0,\n  1,\n  1\n]\n"})}),"\n",(0,i.jsx)(n.h1,{id:"post-deeper-data",children:"post deeper data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST -d \'{"setting":{"cars":true}}\' \\\n-H "Content-Type:application/json" \\\nhttps://cityio.media.mit.edu/api/table/test/new_module | jq .\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "id": "9Dqq91fFjfL5sse9AKyXoUsYXF3Tg62ALpo6fC2B3epB",\n  "status": "ok"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"ver3 lets you send even deeper data, if it's the base data already\nexists"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST -d \'{"pev": true, "cars":false}\' \\\n-H "Content-Type:application/json" \\\nhttps://cityio.media.mit.edu/api/table/test/new_module/setting | jq .\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "commit": "BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b",\n  "status": "ok"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"this case the commit changes"}),"\n",(0,i.jsx)(n.h1,{id:"delete-table",children:"delete table"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -X DELETE https://cityio.media.mit.edu/api/table/test/\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"ok\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/tables/list/\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"[]\n"})}),"\n",(0,i.jsx)(n.h1,{id:"dump-data",children:"dump data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/dump/ | jq .\n"})}),"\n",(0,i.jsx)(n.p,{children:"This gives a good overview of how cityio is internally saving data."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "blob": [\n    {\n      "setting": {\n        "cars": true\n      }\n    },\n    [\n      0,\n      1,\n      0\n    ],\n    42,\n    "hello",\n    {\n      "setting": {\n        "cars": false,\n        "pev": true\n      }\n    },\n    [\n      0,\n      1,\n      1\n    ]\n  ],\n  "commit": [\n    {\n      "parent": "oPuhrsgmJU3aUS5pc2StUrftqUwTDUX3tEweF4NE4fD",\n      "timestamp": "2021-03-27T15:41:45.457952355+00:00",\n      "tree_id": "BGuzwcPaxADXvLkR2uciX1pkRumFGJV25UENUur4mUfa"\n    },\n    {\n      "parent": "F4tCJsaHmvqu2VRGht4Z4GdMttEArHewfUKiFFVz1w78",\n      "timestamp": "2021-03-27T15:44:52.177075895+00:00",\n      "tree_id": "TCMSkt5Sy4MBqb1p6ve6t85CzKyTcuGexgvsHpm26tL"\n    },\n    {\n      "parent": "0",\n      "timestamp": "2021-03-27T15:02:32.840592341+00:00",\n      "tree_id": "55qnpsNMspv9kJJuvQKvoq51s8kRoTN3YX11mVirKnRn"\n    },\n    {\n      "parent": "9Dqq91fFjfL5sse9AKyXoUsYXF3Tg62ALpo6fC2B3epB",\n      "timestamp": "2021-03-27T15:50:19.380681197+00:00",\n      "tree_id": "BKLV9yuZB4fQmdPfgBqf3dNAWendRvCnMbjM4JBGEYdo"\n    },\n    {\n      "parent": "BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b",\n      "timestamp": "2021-03-27T17:04:55.305024404+00:00",\n      "tree_id": "UeD3pVhfBUrnoUjRbVR4W9Sh35gw2zBnWZu86qYFyBg"\n    },\n    {\n      "parent": "6xU8W2WTzwMpyX3vQyRxkbKFxVLfpeV6dERkK9ATukBT",\n      "timestamp": "2021-03-27T15:48:17.106557974+00:00",\n      "tree_id": "8tFUU1YRaENHRBdsWg5q8FFC7jgwZi2Uxi9HAApDsVo1"\n    }\n  ],\n  "tag": [\n    {\n      "commit": "GmJxu8Lq4vT2xx2HaW9nrmTJdprdKkkrFYFkQ8Mq8UcC",\n      "name": "test"\n    }\n  ],\n  "tree": [\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU",\n      "new_module": "2tBViau8ebNWqxbxvqu5pjwFeMk7KjHCVRG4A7e7gubY"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "D9VCvyZn98K9BfSAX26Nm22DTsCfbULokywhdTFKs9Ca"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU",\n      "new_module": "76sjJZQF22BsNYdTP71xpFTHwquQqXzwbfVPiQe5dsYm"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU",\n      "new_module": "B8UAsPeLZskSvLDiWffD1vruGewxMBhMNwQF7xipQpGP"\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.h1,{id:"get-module-by-id",children:"get module by Id"}),"\n",(0,i.jsxs)(n.p,{children:["a ",(0,i.jsx)(n.code,{children:"module"})," is recorded as ",(0,i.jsx)(n.code,{children:"blob"}),". Files are recorded as ",(0,i.jsx)(n.code,{children:"blobs"})," in git."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/module/8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE/\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"42\n"})}),"\n",(0,i.jsx)(n.h1,{id:"get-hashes-by-id",children:"get hashes by Id"}),"\n",(0,i.jsxs)(n.p,{children:["the ",(0,i.jsx)(n.code,{children:"hashes"})," entry in the meta is recorded as a ",(0,i.jsx)(n.code,{children:"tree"}),". Directories are\nrecorded as ",(0,i.jsx)(n.code,{children:"trees"})," in git."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/hashes/BGuzwcPaxADXvLkR2uciX1pkRumFGJV25UENUur4mUfa/ | jq .\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n  "grid": "D9VCvyZn98K9BfSAX26Nm22DTsCfbULokywhdTFKs9Ca"\n}\n'})}),"\n",(0,i.jsx)(n.h1,{id:"get-a-commit-by-id-and-roll-back",children:"get a commit by Id (and roll back)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/commit/GmJxu8Lq4vT2xx2HaW9nrmTJdprdKkkrFYFkQ8Mq8UcC/ | jq .\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "tree_id": "UeD3pVhfBUrnoUjRbVR4W9Sh35gw2zBnWZu86qYFyBg",\n  "parent": "BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b",\n  "timestamp": "2021-03-27T17:04:55.305024404+00:00"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["the ",(0,i.jsx)(n.code,{children:"parent"})," field of this points to other commits. You can roll back to\ndifferent states using this endpoint."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/commit/BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b/ | jq .\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'{\n  "tree_id": "BKLV9yuZB4fQmdPfgBqf3dNAWendRvCnMbjM4JBGEYdo",\n  "parent": "9Dqq91fFjfL5sse9AKyXoUsYXF3Tg62ALpo6fC2B3epB",\n  "timestamp": "2021-03-27T15:50:19.380681197+00:00"\n}\n'})}),"\n",(0,i.jsx)(n.h1,{id:"post-a-table-by-tagging-similar-to-branching",children:"Post a table by 'tagging', similar to branching"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl -X POST https://cityio.media.mit.edu/api/table/raw/new_table/BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b/ | jq .\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl https://cityio.media.mit.edu/api/tables/list/\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'["new_table","test"]\n'})}),"\n",(0,i.jsx)(n.p,{children:"This can be seen as branching, or copying states. You can force merge if\nyou have a commit id to overwrite."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>d});var i=t(6540);const s={},a=i.createContext(s);function c(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);