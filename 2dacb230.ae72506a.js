(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{66:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return l}));var a=n(2),r=n(6),c=(n(0),n(86)),i={id:"API"},b={unversionedId:"backend/API",id:"backend/API",isDocsHomePage:!1,title:"API",description:"Here is a list of APIs exposed for cityio.",source:"@site/docs/backend/Api.md",slug:"/backend/API",permalink:"/backend/API",editUrl:"https://github.com/CityScope/cityscope.github.io/blob/new_docsite/docsite/docs/backend/Api.md",version:"current",sidebar:"sidebar",previous:{title:"CityIO",permalink:"/backend/CityIO"},next:{title:"Build",permalink:"/backend/Build"}},s=[],p={rightToc:s};function l(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"Here is a list of APIs exposed for cityio."),Object(c.b)("h1",{id:"list-tables"},"list tables"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/tables/list/\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'["test"]\n')),Object(c.b)("h1",{id:"get-a-table"},"get a table"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/table/test/ | jq .\n")),Object(c.b)("p",null,Object(c.b)("inlineCode",{parentName:"p"},"| jq .")," is just to pretty format the result."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "data": 42,\n  "grid": [\n    0,\n    1,\n    0\n  ],\n  "meta": {\n    "hash": "BGuzwcPaxADXvLkR2uciX1pkRumFGJV25UENUur4mUfa",\n    "hashes": {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "D9VCvyZn98K9BfSAX26Nm22DTsCfbULokywhdTFKs9Ca"\n    },\n    "id": "F4tCJsaHmvqu2VRGht4Z4GdMttEArHewfUKiFFVz1w78",\n    "timestamp": "2021-03-27T15:41:45.457952355+00:00"\n  }\n}\n')),Object(c.b)("h1",{id:"post-a-table"},"post a table"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},'curl -X POST -d \'{"grid":[0,1,1]}\' \\\n-H "Content-Type:application/json" \\\nhttps://cityio.media.mit.edu/api/table/test/ | jq .\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "id": "6xU8W2WTzwMpyX3vQyRxkbKFxVLfpeV6dERkK9ATukBT",\n  "name": "test",\n  "status": "ok"\n}\n')),Object(c.b)("h1",{id:"get-deeper-data"},"get deeper data"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/table/test/grid | jq .\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},"[\n  0,\n  1,\n  1\n]\n")),Object(c.b)("h1",{id:"post-deeper-data"},"post deeper data"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},'curl -X POST -d \'{"setting":{"cars":true}}\' \\\n-H "Content-Type:application/json" \\\nhttps://cityio.media.mit.edu/api/table/test/new_module | jq .\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "id": "9Dqq91fFjfL5sse9AKyXoUsYXF3Tg62ALpo6fC2B3epB",\n  "status": "ok"\n}\n')),Object(c.b)("p",null,"ver3 lets you send even deeper data, if it's the base data already\nexists"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},'curl -X POST -d \'{"pev": true, "cars":false}\' \\\n-H "Content-Type:application/json" \\\nhttps://cityio.media.mit.edu/api/table/test/new_module/setting | jq .\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "commit": "BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b",\n  "status": "ok"\n}\n')),Object(c.b)("p",null,"this case the commit changes"),Object(c.b)("h1",{id:"delete-table"},"delete table"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl -X DELETE https://cityio.media.mit.edu/api/table/test/\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},"ok\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/tables/list/\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},"[]\n")),Object(c.b)("h1",{id:"dump-data"},"dump data"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/dump/ | jq .\n")),Object(c.b)("p",null,"This gives a good overview of how cityio is internally saving data."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "blob": [\n    {\n      "setting": {\n        "cars": true\n      }\n    },\n    [\n      0,\n      1,\n      0\n    ],\n    42,\n    "hello",\n    {\n      "setting": {\n        "cars": false,\n        "pev": true\n      }\n    },\n    [\n      0,\n      1,\n      1\n    ]\n  ],\n  "commit": [\n    {\n      "parent": "oPuhrsgmJU3aUS5pc2StUrftqUwTDUX3tEweF4NE4fD",\n      "timestamp": "2021-03-27T15:41:45.457952355+00:00",\n      "tree_id": "BGuzwcPaxADXvLkR2uciX1pkRumFGJV25UENUur4mUfa"\n    },\n    {\n      "parent": "F4tCJsaHmvqu2VRGht4Z4GdMttEArHewfUKiFFVz1w78",\n      "timestamp": "2021-03-27T15:44:52.177075895+00:00",\n      "tree_id": "TCMSkt5Sy4MBqb1p6ve6t85CzKyTcuGexgvsHpm26tL"\n    },\n    {\n      "parent": "0",\n      "timestamp": "2021-03-27T15:02:32.840592341+00:00",\n      "tree_id": "55qnpsNMspv9kJJuvQKvoq51s8kRoTN3YX11mVirKnRn"\n    },\n    {\n      "parent": "9Dqq91fFjfL5sse9AKyXoUsYXF3Tg62ALpo6fC2B3epB",\n      "timestamp": "2021-03-27T15:50:19.380681197+00:00",\n      "tree_id": "BKLV9yuZB4fQmdPfgBqf3dNAWendRvCnMbjM4JBGEYdo"\n    },\n    {\n      "parent": "BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b",\n      "timestamp": "2021-03-27T17:04:55.305024404+00:00",\n      "tree_id": "UeD3pVhfBUrnoUjRbVR4W9Sh35gw2zBnWZu86qYFyBg"\n    },\n    {\n      "parent": "6xU8W2WTzwMpyX3vQyRxkbKFxVLfpeV6dERkK9ATukBT",\n      "timestamp": "2021-03-27T15:48:17.106557974+00:00",\n      "tree_id": "8tFUU1YRaENHRBdsWg5q8FFC7jgwZi2Uxi9HAApDsVo1"\n    }\n  ],\n  "tag": [\n    {\n      "commit": "GmJxu8Lq4vT2xx2HaW9nrmTJdprdKkkrFYFkQ8Mq8UcC",\n      "name": "test"\n    }\n  ],\n  "tree": [\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU",\n      "new_module": "2tBViau8ebNWqxbxvqu5pjwFeMk7KjHCVRG4A7e7gubY"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "D9VCvyZn98K9BfSAX26Nm22DTsCfbULokywhdTFKs9Ca"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU",\n      "new_module": "76sjJZQF22BsNYdTP71xpFTHwquQqXzwbfVPiQe5dsYm"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE"\n    },\n    {\n      "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n      "grid": "J1XtoDM5DGKZt97qBy3krz3ihhdtD9mJaxNMf62BAJhU",\n      "new_module": "B8UAsPeLZskSvLDiWffD1vruGewxMBhMNwQF7xipQpGP"\n    }\n  ]\n}\n')),Object(c.b)("h1",{id:"get-module-by-id"},"get module by Id"),Object(c.b)("p",null,"a ",Object(c.b)("inlineCode",{parentName:"p"},"module")," is recorded as ",Object(c.b)("inlineCode",{parentName:"p"},"blob"),". Files are recorded as ",Object(c.b)("inlineCode",{parentName:"p"},"blobs")," in git."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/module/8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE/\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},"42\n")),Object(c.b)("h1",{id:"get-hashes-by-id"},"get hashes by Id"),Object(c.b)("p",null,"the ",Object(c.b)("inlineCode",{parentName:"p"},"hashes")," entry in the meta is recorded as a ",Object(c.b)("inlineCode",{parentName:"p"},"tree"),". Directories are\nrecorded as ",Object(c.b)("inlineCode",{parentName:"p"},"trees")," in git."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/hashes/BGuzwcPaxADXvLkR2uciX1pkRumFGJV25UENUur4mUfa/ | jq .\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "data": "8kzzuAWtRcnhd4SnD2zeEuieq5VtuA8nsNcBgzpRaLuE",\n  "grid": "D9VCvyZn98K9BfSAX26Nm22DTsCfbULokywhdTFKs9Ca"\n}\n')),Object(c.b)("h1",{id:"get-a-commit-by-id-and-roll-back"},"get a commit by Id (and roll back)"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/commit/GmJxu8Lq4vT2xx2HaW9nrmTJdprdKkkrFYFkQ8Mq8UcC/ | jq .\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "tree_id": "UeD3pVhfBUrnoUjRbVR4W9Sh35gw2zBnWZu86qYFyBg",\n  "parent": "BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b",\n  "timestamp": "2021-03-27T17:04:55.305024404+00:00"\n}\n')),Object(c.b)("p",null,"the ",Object(c.b)("inlineCode",{parentName:"p"},"parent")," field of this points to other commits. You can roll back to\ndifferent states using this endpoint."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/commit/BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b/ | jq .\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'{\n  "tree_id": "BKLV9yuZB4fQmdPfgBqf3dNAWendRvCnMbjM4JBGEYdo",\n  "parent": "9Dqq91fFjfL5sse9AKyXoUsYXF3Tg62ALpo6fC2B3epB",\n  "timestamp": "2021-03-27T15:50:19.380681197+00:00"\n}\n')),Object(c.b)("h1",{id:"post-a-table-by-tagging-similar-to-branching"},"Post a table by 'tagging', similar to branching"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl -X POST https://cityio.media.mit.edu/api/table/raw/new_table/BTLvsmmQbJc5JiMZEsrhzMFgBjRRxcH8irDKz99WbC3b/ | jq .\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"curl https://cityio.media.mit.edu/api/tables/list/\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-text"},'["new_table","test"]\n')),Object(c.b)("p",null,"This can be seen as branching, or copying states. You can force merge if\nyou have a commit id to overwrite."))}l.isMDXComponent=!0},86:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=r.a.createContext({}),l=function(e){var t=r.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):b(b({},t),e)),n},o=function(e){var t=l(e.components);return r.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),o=l(n),d=a,m=o["".concat(i,".").concat(d)]||o[d]||u[d]||c;return n?r.a.createElement(m,b(b({ref:t},p),{},{components:n})):r.a.createElement(m,b({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,i=new Array(c);i[0]=d;var b={};for(var s in t)hasOwnProperty.call(t,s)&&(b[s]=t[s]);b.originalType=e,b.mdxType="string"==typeof e?e:a,i[1]=b;for(var p=2;p<c;p++)i[p]=n[p];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);